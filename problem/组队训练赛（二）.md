### 组队训练赛（二）

#### 题目1

##### 题目链接

[问题 A: Matrix Equation](http://icpc.upc.edu.cn/problem.php?cid=2974&pid=0)

##### 题目描述

You are given an integer n. Please output the answer of  ![image.png](https://i.loli.net/2021/09/29/oF5HEDpwS1tIlaP.png) modulo 998244353. n is represented in the form of factorization.

φ(n) is Euler’s totient function, and it is defi ned more formally as the number of integers k in the interval 1≤k≤n for which the greatest common divisor gcd(n,k) is equal to 1.

For example, the totatives of n = 9 are the six numbers 1, 2, 4, 5, 7 and 8. They are all co-prime to 9, but the other three numbers in this interval, 3, 6, and 9 are not, because gcd(9,3) = gcd(9,6) = 3 and gcd(9,9) = 9. 

Therefore, φ(9) = 6. As another example, φ(1) = 1 since for n = 1 the only integer in the interval from 1 to n is 1 itself, and gcd(1,1) = 1.

And there are several formulas for computing φ(n), for example, Euler’s product formula states like:
![image.png](https://i.loli.net/2021/09/29/A5koZWXTrLBHN8E.png)

where the product is all the distinct prime numbers (p in the formula) dividing n.

##### 输入

The fi rst line contains an integer T (1≤T≤20) representing the number of test cases.

For each test case, the fi rst line contains an integer m￿(1≤m≤20) is the number of prime factors.

The following m lines each contains two integers pi and qi (2≤pi≤108 , 1≤qi≤108 ) describing that n contains the factor piqi , in other words, ![image.png](https://i.loli.net/2021/09/29/zw3xavC7GkQgh1Y.png). It is guaranteed that all pi are prime numbers and diff erent from each other.

##### 输出

For each test case, print the the answer modulo 998244353 in one line.

##### 样例输入

```
2
2
2 1
3 1
2
2 2
3 2
```
##### 样例输出
```
15
168
```
##### 提示

For first test case, n = 21*31= 6, and the answer is (φ(1)*n/1+φ(2)*n/2+φ(3)*n/3+φ(6)*n/6) mod 998244353 = (6 + 3 + 4 + 2) mod 998244353 = 15.

##### 题解

题目要求求解$ F(n)=\sum_{d|n} \varphi(d)*\frac{n}{d} $，由于欧拉函数和$\frac{n}{d}$均为积性函数，则有

$ F(m*n)=F(m)*F(n) $

即为$ F( \prod p_i^{q_i})=\prod F(p_i^{q_i}) $，则

$ F(p_i^{q_i})=\sum_{d|n}\varphi(d)*\frac{n}{d}=\varphi(1)*n+\sum_{i=1}^{q} \varphi(p^i)*\frac{n}{p^i}=p_i^{q_i}+\sum _{i=1} ^{q_i}(p_i-1)*(p_i^{i-1}*\frac{p_i^{q_i}}{p_i}) $

$ =p_i^{q_i}+p_i^{q_i-1}*(p_i-1)*{q_i}=p_i^{q_i-1}*(p_i+q_i*(p_i-1)) $

参考链接：

[https://blog.csdn.net/xiongshuxian2019/article/details/109631325](https://blog.csdn.net/xiongshuxian2019/article/details/109631325)

[https://blog.csdn.net/consciousman/article/details/77888386](https://blog.csdn.net/consciousman/article/details/77888386)

[https://www.cnblogs.com/letlifestop/p/10262791.html](https://www.cnblogs.com/letlifestop/p/10262791.html)

##### 代码

```c++
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const ll mod = 998244353;
ll ksm(ll a, ll b)
{
    ll ans1 = 1, ans2 = a;
    while (b != 0)
    {
        if (b & 1)
            ans1 = (ans1 * ans2) % mod;
        ans2 = (ans2 * ans2) % mod;
        b /= 2;
    }
    return ans1;
}
int main()
{
    int t;
    scanf("%d", &t);
    while (t--)
    {
        ll n, p, q, ans = 1;
        scanf("%lld", &n);
        for (int i = 1; i <= n; i++)
        {
            scanf("%lld%lld", &p, &q);
            ans = (ans * ksm(p, q - 1) % mod * ((p + q * (p - 1)) % mod + mod) % mod) % mod;
        }
        printf("%lld\n", ans % mod);
    }
    return 0;
}
```

